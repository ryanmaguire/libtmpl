#ifndef TMPL_BESSEL_J0_FIRST_ZERO_DOUBLE_H
#define TMPL_BESSEL_J0_FIRST_ZERO_DOUBLE_H

#include <libtmpl/include/tmpl_config.h>
#include <libtmpl/include/tmpl_special_functions_real.h>

/*  Coefficients for the numerator of the Remez rational approximation.       */
#define P00 (-5.1914749728946678623682802757978191553944729886660E-01)
#define P01 (+1.2210769566580767469174329722482526537193130555196E-01)
#define P02 (+4.3715927338072358223406495793677323372011063735512E-02)
#define P03 (-7.8919830962943140306150893868719087653796726937500E-03)
#define P04 (-1.0111018746141707967892297901104864292993239777203E-03)
#define P05 (+1.5134745002921224717519580967030253469451995825731E-04)
#define P06 (+7.3050206993387409555992911578170584932120052306920E-06)
#define P07 (-9.6922595963923003291275771329396348850341315760091E-07)

/*  Coefficients for the denominator of the Remez rational approximation.     */
#define Q00 (+1.0000000000000000000000000000000000000000000000000E+00)
#define Q01 (-2.7292809817760225584111964181902210384353600790766E-02)
#define Q02 (+1.9146575285054908443563136169048212227611522843915E-02)
#define Q03 (-4.6971522359863859017755968581333028358012915004436E-04)
#define Q04 (+1.6608638169818593918952125675060033275805987301661E-04)
#define Q05 (-2.9063215978959834083195938531339991564589013753491E-06)
#define Q06 (+6.7586960815374906344078147975212420914816980495126E-07)

#define TMPL_NUM_EVAL(z) \
P00 + z*(P01 + z*(P02 + z*(P03 + z*(P04 + z*(P05 + z*(P06 + z*P07))))))

#define TMPL_DEN_EVAL(z) \
Q00 + z*(Q01 + z*(Q02 + z*(Q03 + z*(Q04 + z*(Q05 + z*Q06)))))

#define J0_ZERO_HI (+2.4048255576957728862907970324158668518066E+00)
#define J0_ZERO_LO (-1.1766916515308940362785587811429253257372E-16)

TMPL_INLINE_DECL
double tmpl_Double_Bessel_J0_First_Zero(double x)
{
    const double z = (x - J0_ZERO_HI) - J0_ZERO_LO;
    const double p = TMPL_NUM_EVAL(z);
    const double q = TMPL_DEN_EVAL(z);
    return z * p / q;
}

#undef P00
#undef P01
#undef P02
#undef P03
#undef P04
#undef P05
#undef P06
#undef P07
#undef P08
#undef P09
#undef P10
#undef P11

#undef Q00
#undef Q01
#undef Q02
#undef Q03
#undef Q04
#undef Q05
#undef Q06
#undef Q07
#undef Q08

#undef TMPL_NUM_EVAL
#undef TMPL_DEN_EVAL

#undef J0_ZERO_HI
#undef J0_ZERO_LO

#endif
