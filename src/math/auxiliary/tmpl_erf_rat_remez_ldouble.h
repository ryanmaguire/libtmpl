#ifndef TMPL_ERF_RAT_REMEZ_LDOUBLE_H
#define TMPL_ERF_RAT_REMEZ_LDOUBLE_H

#include <libtmpl/include/tmpl_config.h>

/*  64-bit long double does not need any more precision than 64-bit double.   */
#if TMPL_LDOUBLE_ENDIANNESS == TMPL_LDOUBLE_64_BIT_LITTLE_ENDIAN || \
    TMPL_LDOUBLE_ENDIANNESS == TMPL_LDOUBLE_64_BIT_BIG_ENDIAN

/*  Coefficients for the numerator of the Remez rational approximation.       */
#define P00 (+1.1283791670955126365607040611486440894548731064430E+00L)
#define P01 (+6.1856680806948109220677660264677907003149751444417E-02L)
#define P02 (+4.1145518213074999565262794018611561200627595655126E-02L)
#define P03 (-8.7707136933607770079319073352925173083333681109000E-04L)
#define P04 (+2.7125577380014977514418180966266226228905135708230E-04L)
#define P05 (-1.3239722107678831460532410663306244658302355190564E-05L)
#define P06 (+6.2564335958048129592868311685179924773329314231658E-07L)
#define P07 (-1.8239148907346264717934021446679328630982359872721E-08L)
#define P08 (+2.5839003238848066077920003511476230831774264021355E-10L)

/*  Coefficients for the denominator of the Remez rational approximation.     */
#define Q00 (+1.0000000000000000000000000000000000000000000000000E+00L)
#define Q01 (+3.8815238938359424075188631415877534713061633081189E-01L)
#define Q02 (+6.5848395896534329559179312445593670161084460771079E-02L)
#define Q03 (+6.1664659079696183164995589642551932095328093191702E-03L)
#define Q04 (+3.2313713982428331981430572957719222195415860127493E-04L)
#define Q05 (+7.7253055534510380898965062146051908309590150561640E-06L)

#define TMPL_NUM_EVAL(z)\
P00+z*(P01+z*(P02+z*(P03+z*(P04+z*(P05+z*(P06+z*(P07+z*P08)))))))

#define TMPL_DEN_EVAL(z) Q00+z*(Q01+z*(Q02+z*(Q03+z*(Q04+z*Q05))))

/*  double-double, more terms are needed.                                     */
#elif \
    TMPL_LDOUBLE_ENDIANNESS == TMPL_LDOUBLE_128_BIT_DOUBLEDOUBLE_BIG_ENDIAN || \
    TMPL_LDOUBLE_ENDIANNESS == TMPL_LDOUBLE_128_BIT_DOUBLEDOUBLE_LITTLE_ENDIAN

/*  Coefficients for the numerator of the Remez rational approximation.       */
#define P00 (+1.1283791670955125738961589031212727294870750687715E+00L)
#define P01 (+1.6481445917361372356234895154099539962449399316994E-01L)
#define P02 (+5.3288421098138008475857830613481772049564319868130E-02L)
#define P03 (+3.4429878996837780040493424307739942454187484369174E-03L)
#define P04 (+4.3923792199955675768169094279054250037760135592536E-04L)
#define P05 (+1.3934772114281130991919517601923412180001221984541E-05L)
#define P06 (+8.0592060936337269207584574368163729591726596548390E-07L)
#define P07 (+9.1900707381095805189832366401757297600104948544386E-09L)
#define P08 (+1.0953725180795426360520099675662028709680774611488E-10L)

/*  Coefficients for the denominator of the Remez rational approximation.     */
#define Q00 (+1.0000000000000000000000000000000000000000000000000E+00L)
#define Q01 (+4.7939634475692413185988724763857723087642925956647E-01L)
#define Q02 (+1.0702441517767610745070140987563390932764418820993E-01L)
#define Q03 (+1.4595962973764568903443951598246861666003103200031E-02L)
#define Q04 (+1.3367130017022112584555977660726538972777646748703E-03L)
#define Q05 (+8.4672670364872379949186983681016418338510222039467E-05L)
#define Q06 (+3.6481183956235711198256231229456915965226634619851E-06L)
#define Q07 (+9.8571735384459711040848075907991118700344372897019E-08L)
#define Q08 (+1.2922305247666508073300384296640524657066259766571E-09L)

#define TMPL_NUM_EVAL(z) \
P00+z*(P01+z*(P02+z*(P03+z*(P04+z*(P05+z*(P06+z*(P07+z*P08)))))))

#define TMPL_DEN_EVAL(z) \
Q00+z*(Q01+z*(Q02+z*(Q03+z*(Q04+z*(Q05+z*(Q06+z*(Q07+z*Q08)))))))

/*  128-bit quadruple, a few more terms.                                      */
#elif \
    TMPL_LDOUBLE_ENDIANNESS == TMPL_LDOUBLE_128_BIT_QUADRUPLE_LITTLE_ENDIAN || \
    TMPL_LDOUBLE_ENDIANNESS == TMPL_LDOUBLE_128_BIT_QUADRUPLE_BIG_ENDIAN

/*  Coefficients for the numerator of the Remez rational approximation.       */
#define P00 (+1.1283791670955125738961589031215450925461937445034E+00L)
#define P01 (+1.9167553809685773590090320842736491469982132290186E-01L)
#define P02 (+6.0430270116129290485566314692192123276810942583437E-02L)
#define P03 (+5.2349408752396594611785160546430214710107182146056E-03L)
#define P04 (+6.8157644700161560605219470675111811301735830588175E-04L)
#define P05 (+3.6809637459405074974689809528622789561307343123609E-05L)
#define P06 (+2.5819892780684951650988197546541824706777328399458E-06L)
#define P07 (+9.0637781626484216357375437695628661566850235662313E-08L)
#define P08 (+3.5711426154090411220577697422034066201228889291404E-09L)
#define P09 (+7.6606077908323609985294261855033263569443815161059E-11L)
#define P10 (+1.4727195396209061813861131529033475289357638160584E-12L)
#define P11 (+1.4368673777640053659681760206830409665051904804155E-14L)
#define P12 (+4.0099201423628270409224462118525426216683603722692E-17L)

/*  Coefficients for the denominator of the Remez rational approximation.     */
#define Q00 (+1.0000000000000000000000000000000000000000000000000E+00L)
#define Q01 (+5.0320135614541455267710547396532579869360674475609E-01L)
#define Q02 (+1.2128871787110179396387996592506591654856264576184E-01L)
#define Q03 (+1.8558306375473565718630262303472210468546138864339E-02L)
#define Q04 (+2.0126167776342206012873580739822615661532108354688E-03L)
#define Q05 (+1.6342977897047831419027732242198902130279251886932E-04L)
#define Q06 (+1.0221280919029929361034269583405622449498283669106E-05L)
#define Q07 (+4.9788030615281327892591485758581555391913863431080E-07L)
#define Q08 (+1.8824152040975166387148890250641629886628579191817E-08L)
#define Q09 (+5.4138092093559879054959413876064527702175675028954E-10L)
#define Q10 (+1.1307770492449121543261611414199506879232122192075E-11L)
#define Q11 (+1.5510533383141102786900561491342341846191486585449E-13L)
#define Q12 (+1.0660611242615620734576686895535117293102950380867E-15L)

/*  Helper macro for evaluating a polynomial via Horner's method.             */
#define TMPL_NUM_EVAL(z) \
P00 + z*(\
    P01 + z*(\
        P02 + z*(\
            P03 + z*(\
                P04 + z*(\
                    P05 + z*(\
                        P06 + z*(\
                            P07 + z*(\
                                P08 + z*(\
                                    P09 + z*(\
                                        P10 + z*(\
                                            P11 + z*P12\
                                        )\
                                    )\
                                )\
                            )\
                        )\
                    )\
                )\
            )\
        )\
    )\
)

#define TMPL_DEN_EVAL(z) \
Q00 + z*(\
    Q01 + z*(\
        Q02 + z*(\
            Q03 + z*(\
                Q04 + z*(\
                    Q05 + z*(\
                        Q06 + z*(\
                            Q07 + z*(\
                                Q08 + z*(\
                                    Q09 + z*(\
                                        Q10 + z*(\
                                            Q11 + z*Q12\
                                        )\
                                    )\
                                )\
                            )\
                        )\
                    )\
                )\
            )\
        )\
    )\
)

#else

/*  Coefficients for the numerator of the Remez rational approximation.       */
#define P00 (+1.1283791670955125739314171099502484148921208531728E+00L)
#define P01 (+1.4920278237619000520975885116068698561112023586927E-01L)
#define P02 (+5.0588484962684315204267352164775505017461778659975E-02L)
#define P03 (+2.6489483697996107296745572800020345150179790692195E-03L)
#define P04 (+3.7382085181878354886406664584462812986478153325447E-04L)
#define P05 (+6.9849093394408771121764941438879029490407386521203E-06L)
#define P06 (+5.2271592348959230742733499169922504752755806934622E-07L)
#define P07 (-2.2548217663449974511513795025550328723019126737930E-09L)
#define P08 (+4.4833375185725042453350109956947121349577136152256E-11L)

/*  Coefficients for the denominator of the Remez rational approximation.     */
#define Q00 (+1.0000000000000000000000000000000000000000000000000E+00L)
#define Q01 (+4.6556085642758115526601848367010609878104037398728E-01L)
#define Q02 (+1.0001982963431972190942543669112576477130666430471E-01L)
#define Q03 (+1.2940950747657570801136517026358823617460758702752E-02L)
#define Q04 (+1.0981100562225000377092715573987637968278869464382E-03L)
#define Q05 (+6.1757762759998746846404373055996794564606731333935E-05L)
#define Q06 (+2.1612799584693033700667928383065551889479216822305E-06L)
#define Q07 (+3.7024380616574339157661134936776156061716153770560E-08L)

#define TMPL_NUM_EVAL(z) \
P00+z*(P01+z*(P02+z*(P03+z*(P04+z*(P05+z*(P06+z*(P07+z*P08)))))))

#define TMPL_DEN_EVAL(z) \
Q00+z*(Q01+z*(Q02+z*(Q03+z*(Q04+z*(Q05+z*(Q06+z*Q07))))))

#endif

TMPL_STATIC_INLINE
long double tmpl_LDouble_Erf_Rat_Remez(long double x)
{
    const long double x2 = x*x;
    const long double p = TMPL_NUM_EVAL(x2);
    const long double q = TMPL_DEN_EVAL(x2);
    return x * p / q;
}

#undef TMPL_NUM_EVAL
#undef TMPL_DEN_EVAL
#undef P00
#undef P01
#undef P02
#undef P03
#undef P04
#undef P05
#undef P06
#undef P07
#undef P08
#undef P09
#undef P10
#undef P11
#undef Q12
#undef Q00
#undef Q01
#undef Q02
#undef Q03
#undef Q04
#undef Q05
#undef Q06
#undef Q07
#undef Q08
#undef Q09
#undef Q10
#undef Q11
#undef Q12

#endif
